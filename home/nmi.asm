NMI:
	.ORG $C000

label_8
	PHP
label_9
	PHA
	TXA
	PHA
	TYA
	PHA
	LDA PPU_STATUS
	LDA $FF
	AND #$7F
	STA PPU_CTRL
	LDA #$00
	STA PPU_MASK
	LDA $EE
	ORA $9A
	BNE label_1
	LDA $FC
	STA $79
	LDA $FD
	STA $7A
	LDA $F8
	STA $78
	LDA $50
	BNE label_2
	LDA $5E
	STA $7B
label_2
	LDA #$00
	STA PPU_OAM_ADDR
	LDA #$02
	STA OAM_DMA
	LDA $19
	BEQ label_3
	JSR $C4F8
label_3
	LDA $1A
	BEQ label_4
	LDA $FF
	AND #$7F
	ORA #$04
	STA PPU_CTRL
	LDX #$00
	STX $1A
	JSR $C4FC
	LDA $FF
	AND #$7F
	STA PPU_CTRL
label_4
	LDA $18
	BEQ label_1
	LDX #$00
	STX $18
	LDA PPU_STATUS
	LDA #$3F
	STA PPU_ADDRESS
	STX PPU_ADDRESS
	LDY #$20
label_5
	LDA $0600,X
	STA PPU_DATA
	INX
	DEY
	BNE label_5
	LDA #$3F
	STA PPU_ADDRESS
	STY PPU_ADDRESS
	STY PPU_ADDRESS
	STY PPU_ADDRESS
label_1
	LDA $78
	CMP #$02
	BNE label_6
	LDA PPU_STATUS
	LDA $5F
	STA PPU_SCROLL
	LDA #$00
	STA PPU_SCROLL
	BEQ label_7
label_6
	LDA PPU_STATUS
	LDA $79
	STA PPU_SCROLL
	LDA $FA
	STA PPU_SCROLL
label_7
	LDA $FE
	STA PPU_MASK
	LDA $7A
	AND #$03
	ORA $FF
	STA PPU_CTRL
	JSR $FF41
	LDA $F0
	STA $8000
	LDA $7B
	STA label_8
	STA label_9
	LDX $9B
	STA $E000,X
	BEQ label_10
	LDX $78
	LDA $50
	BEQ label_11
	LDA $7B
	CMP $51
	BCC label_11
	LDX #$01
label_11
	LDA $C4C8,X
	STA $9C
	LDA $C4DA,X
	STA $9D
label_10
	INC $92
	LDX #$FF
	STX $90
	INX
	LDY #$04
label_13
	LDA $80,X
	CMP #$01
	BNE label_12
	DEC $81,X
	BNE label_12
	LDA #$04
	STA $80,X
label_12
	INX
	INX
	INX
	INX
	DEY
	BNE label_13
	TSX
	LDA $0107,X
	STA $7D
	LDA $0106,X
	STA $7C
	LDA #$C1
	STA $0107,X
	LDA #$21
	STA $0106,X
	PLA
	TAY
	PLA
	TAX
	PLA
	PLP
	RTI
	PHP
	PHP
	PHP
	PHA
	TXA
	PHA
	TYA
	PHA
	TSX
	SEC
	LDA $7C
	SBC #$01
	STA $0105,X
	LDA $7D
	SBC #$00
	STA $0106,X
	JSR $FF90
	PLA
	TAY
	PLA
	TAX
	PLA
	PLP
	RTS
